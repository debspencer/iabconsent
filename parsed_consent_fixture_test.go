package iabconsent_test

import (
	"time"

	"github.com/debspencer/iabconsent"
)

type consentType int

const (
	BitField consentType = iota
	SingleRangeWithSingleID
	SingleRangeWithRange
	MultipleRangesWithSingleID
	MultipleRangesWithRange
	MultipleRangesMixed
	V2
)

const nsPerDs = int64(time.Millisecond * 100)

var testTime = time.Unix(1525378200, 8*nsPerDs).UTC()

var consentFixtures = map[consentType]*iabconsent.ParsedConsent{
	// BONMj34ONMj34ABACDENALqAAAAAplY
	BitField: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10,
		ConsentedVendors: map[int]bool{
			1:  true,
			2:  true,
			5:  true,
			7:  true,
			9:  true,
			10: true,
		},
	},
	// BONMj34ONMj34ABACDENALqAAAAAqABAD2AAAAAAAAAAAAAAAAAAAAAAAAAA
	SingleRangeWithSingleID: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10, // why would max-vendor id be 10, yet we have vender 123
		ConsentedVendors: map[int]bool{
			123: true,
		},
	},
	// BONMj34ONMj34ABACDENALqAAAAAqABgD2AdQAAAAAAAAAAAAAAAAAAAAAAAAAA
	SingleRangeWithRange: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10,
		ConsentedVendors: map[int]bool{
			123: true,
			124: true,
			125: true,
			126: true,
			127: true,
			128: true,
			129: true,
			130: true,
			131: true,
			132: true,
			133: true,
			134: true,
			135: true,
			136: true,
			137: true,
			138: true,
			139: true,
			140: true,
			141: true,
			142: true,
			143: true,
			144: true,
			145: true,
			146: true,
			147: true,
			148: true,
			149: true,
			150: true,
			151: true,
			152: true,
			153: true,
			154: true,
			155: true,
			156: true,
			157: true,
			158: true,
			159: true,
			160: true,
			161: true,
			162: true,
			163: true,
			164: true,
			165: true,
			166: true,
			167: true,
			168: true,
			169: true,
			170: true,
			171: true,
			172: true,
			173: true,
			174: true,
			175: true,
			176: true,
			177: true,
			178: true,
			179: true,
			180: true,
			181: true,
			182: true,
			183: true,
			184: true,
			185: true,
			186: true,
			187: true,
			188: true,
			189: true,
			190: true,
			191: true,
			192: true,
			193: true,
			194: true,
			195: true,
			196: true,
			197: true,
			198: true,
			199: true,
			200: true,
			201: true,
			202: true,
			203: true,
			204: true,
			205: true,
			206: true,
			207: true,
			208: true,
			209: true,
			210: true,
			211: true,
			212: true,
			213: true,
			214: true,
			215: true,
			216: true,
			217: true,
			218: true,
			219: true,
			220: true,
			221: true,
			222: true,
			223: true,
			224: true,
			225: true,
			226: true,
			227: true,
			228: true,
			229: true,
			230: true,
			231: true,
			232: true,
			233: true,
			234: true,
		},
	},
	// BONMj34ONMj34ABACDENALqAAAAAqACAD2AOoAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	MultipleRangesWithSingleID: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10,
		ConsentedVendors: map[int]bool{
			123: true,
			234: true,
		},
	},
	// BONMj34ONMj34ABACDENALqAAAAAqACgD2AdUBWQHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	MultipleRangesWithRange: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10,
		ConsentedVendors: map[int]bool{
			123: true,
			124: true,
			125: true,
			126: true,
			127: true,
			128: true,
			129: true,
			130: true,
			131: true,
			132: true,
			133: true,
			134: true,
			135: true,
			136: true,
			137: true,
			138: true,
			139: true,
			140: true,
			141: true,
			142: true,
			143: true,
			144: true,
			145: true,
			146: true,
			147: true,
			148: true,
			149: true,
			150: true,
			151: true,
			152: true,
			153: true,
			154: true,
			155: true,
			156: true,
			157: true,
			158: true,
			159: true,
			160: true,
			161: true,
			162: true,
			163: true,
			164: true,
			165: true,
			166: true,
			167: true,
			168: true,
			169: true,
			170: true,
			171: true,
			172: true,
			173: true,
			174: true,
			175: true,
			176: true,
			177: true,
			178: true,
			179: true,
			180: true,
			181: true,
			182: true,
			183: true,
			184: true,
			185: true,
			186: true,
			187: true,
			188: true,
			189: true,
			190: true,
			191: true,
			192: true,
			193: true,
			194: true,
			195: true,
			196: true,
			197: true,
			198: true,
			199: true,
			200: true,
			201: true,
			202: true,
			203: true,
			204: true,
			205: true,
			206: true,
			207: true,
			208: true,
			209: true,
			210: true,
			211: true,
			212: true,
			213: true,
			214: true,
			215: true,
			216: true,
			217: true,
			218: true,
			219: true,
			220: true,
			221: true,
			222: true,
			223: true,
			224: true,
			225: true,
			226: true,
			227: true,
			228: true,
			229: true,
			230: true,
			231: true,
			232: true,
			233: true,
			234: true,
			//
			345: true,
			346: true,
			347: true,
			348: true,
			349: true,
			350: true,
			351: true,
			352: true,
			353: true,
			354: true,
			355: true,
			356: true,
			357: true,
			358: true,
			359: true,
			360: true,
			361: true,
			362: true,
			363: true,
			364: true,
			365: true,
			366: true,
			367: true,
			368: true,
			369: true,
			370: true,
			371: true,
			372: true,
			373: true,
			374: true,
			375: true,
			376: true,
			377: true,
			378: true,
			379: true,
			380: true,
			381: true,
			382: true,
			383: true,
			384: true,
			385: true,
			386: true,
			387: true,
			388: true,
			389: true,
			390: true,
			391: true,
			392: true,
			393: true,
			394: true,
			395: true,
			396: true,
			397: true,
			398: true,
			399: true,
			400: true,
			401: true,
			402: true,
			403: true,
			404: true,
			405: true,
			406: true,
			407: true,
			408: true,
			409: true,
			410: true,
			411: true,
			412: true,
			413: true,
			414: true,
			415: true,
			416: true,
			417: true,
			418: true,
			419: true,
			420: true,
			421: true,
			422: true,
			423: true,
			424: true,
			425: true,
			426: true,
			427: true,
			428: true,
			429: true,
			430: true,
			431: true,
			432: true,
			433: true,
			434: true,
			435: true,
			436: true,
			437: true,
			438: true,
			439: true,
			440: true,
			441: true,
			442: true,
			443: true,
			444: true,
			445: true,
			446: true,
			447: true,
			448: true,
			449: true,
			450: true,
			451: true,
			452: true,
			453: true,
			454: true,
			455: true,
			456: true,
		},
	},
	// BONMj34ONMj34ABACDENALqAAAAAqACAD3AVkByAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	MultipleRangesMixed: {
		Version:           1,
		Created:           testTime,
		LastUpdated:       testTime,
		CMPID:             1,
		CMPVersion:        2,
		ConsentScreen:     3,
		ConsentLanguage:   "EN",
		VendorListVersion: 11,
		PurposesAllowed: map[int]bool{
			1: true,
			3: true,
			5: true,
		},
		MaxVendorID: 10,
		ConsentedVendors: map[int]bool{
			123: true,
			//

			345: true,
			346: true,
			347: true,
			348: true,
			349: true,
			350: true,
			351: true,
			352: true,
			353: true,
			354: true,
			355: true,
			356: true,
			357: true,
			358: true,
			359: true,
			360: true,
			361: true,
			362: true,
			363: true,
			364: true,
			365: true,
			366: true,
			367: true,
			368: true,
			369: true,
			370: true,
			371: true,
			372: true,
			373: true,
			374: true,
			375: true,
			376: true,
			377: true,
			378: true,
			379: true,
			380: true,
			381: true,
			382: true,
			383: true,
			384: true,
			385: true,
			386: true,
			387: true,
			388: true,
			389: true,
			390: true,
			391: true,
			392: true,
			393: true,
			394: true,
			395: true,
			396: true,
			397: true,
			398: true,
			399: true,
			400: true,
			401: true,
			402: true,
			403: true,
			404: true,
			405: true,
			406: true,
			407: true,
			408: true,
			409: true,
			410: true,
			411: true,
			412: true,
			413: true,
			414: true,
			415: true,
			416: true,
			417: true,
			418: true,
			419: true,
			420: true,
			421: true,
			422: true,
			423: true,
			424: true,
			425: true,
			426: true,
			427: true,
			428: true,
			429: true,
			430: true,
			431: true,
			432: true,
			433: true,
			434: true,
			435: true,
			436: true,
			437: true,
			438: true,
			439: true,
			440: true,
			441: true,
			442: true,
			443: true,
			444: true,
			445: true,
			446: true,
			447: true,
			448: true,
			449: true,
			450: true,
			451: true,
			452: true,
			453: true,
			454: true,
			455: true,
			456: true,
		},
	},
	// Version 2

	// COvVNSUOvVNSUKyACDENAPCEANAAABwAAAIgBAwAgAVQCAAIEAgYAQAQoBAAECAA.IFoEUQQgAIQwgIwQABAEAAAAOIAACAIAAAAQAIAgEAACEAAAAAgAQBAAAAAAAGBAAgAAAAAAAFAAECAAAgAAQARAEQAAAAAJAAIAAgAAAYQEAAAQmAgBC3ZAYzUw.QD5QAoBAAECAfIA
	V2: {
		Version:              2,
		Created:              time.Unix(1582647413, 200*int64(time.Millisecond)).UTC(),
		LastUpdated:          time.Unix(1582647413, 200*int64(time.Millisecond)).UTC(),
		CMPID:                690,
		CMPVersion:           2,
		ConsentScreen:        3,
		ConsentLanguage:      "EN",
		VendorListVersion:    15,
		PolicyVersion:        2,
		IsSpecificService:    false,
		UseNonStandardStacks: false,
		SpecialFeatureOptins: map[int]bool{
			2: true,
		},
		PurposesAllowed: map[int]bool{
			1: true,
			2: true,
			4: true,
		},
		PurposesTransparancy: map[int]bool{
			4: true,
			5: true,
			6: true,
		},
		PurposeOneTreatment: false,
		PublisherCC:         "BE",
		MaxVendorID:         129,
		ConsentedVendors: map[int]bool{
			42:  true,
			128: true,
			129: true,
		},
		LegitMaxVendorID: 129,
		LegitConsentedVendors: map[int]bool{
			66:  true,
			128: true,
			129: true,
		},
		NumPubRestrictions: 0,
		PubRestrictions:    []*iabconsent.PubRestriction{},
		DisclosedVendors: &iabconsent.Vendors{
			SegmentType: 1,
			MaxVendorID: 720,
			ConsentedVendors: map[int]bool{
				2:   true,
				6:   true,
				8:   true,
				12:  true,
				18:  true,
				23:  true,
				37:  true,
				42:  true,
				47:  true,
				48:  true,
				53:  true,
				61:  true,
				65:  true,
				66:  true,
				72:  true,
				88:  true,
				98:  true,
				127: true,
				128: true,
				129: true,
				133: true,
				153: true,
				163: true,
				192: true,
				205: true,
				215: true,
				224: true,
				243: true,
				248: true,
				281: true,
				294: true,
				304: true,
				350: true,
				351: true,
				358: true,
				371: true,
				422: true,
				424: true,
				440: true,
				447: true,
				467: true,
				486: true,
				498: true,
				502: true,
				512: true,
				516: true,
				553: true,
				556: true,
				571: true,
				587: true,
				612: true,
				613: true,
				618: true,
				626: true,
				648: true,
				653: true,
				656: true,
				657: true,
				665: true,
				676: true,
				681: true,
				683: true,
				684: true,
				686: true,
				687: true,
				688: true,
				690: true,
				691: true,
				694: true,
				702: true,
				703: true,
				707: true,
				708: true,
				711: true,
				712: true,
				714: true,
				716: true,
				719: true,
				720: true,
			},
		},
		AllowedVendors: &iabconsent.Vendors{
			SegmentType: 2,
			MaxVendorID: 498,
			ConsentedVendors: map[int]bool{
				128: true,
				129: true,
				498: true,
			},
		},
		PublisherTC: nil,
	},
}
